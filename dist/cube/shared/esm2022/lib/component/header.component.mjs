import { Component, Inject } from '@angular/core';
import { faCube } from '@fortawesome/free-solid-svg-icons';
import * as i0 from "@angular/core";
import * as i1 from "keycloak-angular";
import * as i2 from "@ngx-translate/core";
import * as i3 from "../services/auth/auth.service";
import * as i4 from "../services/websocket/websocket.service";
import * as i5 from "../services/user/user.service";
import * as i6 from "@angular/common";
import * as i7 from "@ng-bootstrap/ng-bootstrap";
import * as i8 from "@angular/router";
export class HeaderComponent {
    constructor(keycloak, translateService, auth, webSocket, userService, config) {
        this.keycloak = keycloak;
        this.translateService = translateService;
        this.auth = auth;
        this.webSocket = webSocket;
        this.userService = userService;
        this.config = config;
        this.imgSrc = 'assets/images/profile.jpg';
        this.icon = faCube;
        this.languages = [];
        this.isNavbarCollapsed = true;
        this.stati = [
            {
                name: 'online',
                iconPath: 'assets/images/ONLINE.png',
            },
            {
                name: 'busy',
                iconPath: 'assets/images/BUSY.png',
            },
            {
                name: 'invisible',
                iconPath: 'assets/images/INVISIBLE.png',
            },
        ];
        console.log('HeaderComponent costruttore chiamato');
        this.languages = [
            {
                name: 'English',
                langIdentifier: 'en-EN',
                flagPath: 'assets/images/en-EN.png',
            },
            {
                name: 'Italiano',
                langIdentifier: 'it-IT',
                flagPath: 'assets/images/it-IT.png',
            },
            {
                name: 'Français',
                langIdentifier: 'fr-FR',
                flagPath: 'assets/images/fr-FR.png',
            }
        ].sort();
    }
    ngOnInit() {
        this.auth.userDTOBehaviorSubject.subscribe({
            next: (receivedUserDTO) => {
                this.userDTO = receivedUserDTO;
                if (this.userDTO?.propertiesDTO?.defaultLanguage) {
                    this.translateService.use(this.userDTO.propertiesDTO.defaultLanguage);
                }
            },
        });
    }
    login() {
        this.keycloak.login({
            redirectUri: this.config.loginRedirectChatHomePage
        });
    }
    logout() {
        this.webSocket.disconnect().then(() => {
            this.keycloak.logout(this.config.redirectUri);
        });
    }
    changeLanguage(lang) {
        this.translateService.use(lang);
    }
    updateStatus(status) {
        this.userService.updateStatus(status).subscribe({
            next: (response) => {
                if (response && this.userDTO) {
                    this.userDTO.propertiesDTO.status = status;
                    this.auth.userDTOBehaviorSubject.next(this.userDTO);
                }
            },
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: HeaderComponent, deps: [{ token: i1.KeycloakService }, { token: i2.TranslateService }, { token: i3.AuthService }, { token: i4.WebSocketService }, { token: i5.UserService }, { token: 'SHARED_CONFIG' }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: HeaderComponent, selector: "cube-header", ngImport: i0, template: "<nav class=\"navbar navbar-expand-xl\">\r\n    <div class=\"container-fluid\">\r\n\r\n        <!-- ## NAVBAR HOME TO PORTAL ## -->\r\n        <div class=\"navbar-brand\">\r\n            <a href=\"https://docmon.pccube.com/portal\">\r\n                <img alt=\"cubePortalLogo\" class=\"home\" src=\"assets/images/pccube-solo-cubo.png\">\r\n            </a>\r\n        </div>\r\n\r\n        <!-- ## NAVBAR LOGO ## -->\r\n        <div class=\"navbar-brand\">\r\n            <img alt=\"cubeChatLogo\" routerLink=\"/\" style=\"cursor:pointer;width: 275px; height: 50px;\"\r\n                src=\"assets/images/pccube.png\">\r\n        </div>\r\n\r\n        <!-- ## NAVBAR TOGGLER - QUANDO SCHERMO PICCOLO ## -->\r\n        <button class=\"navbar-toggler shadow-none\" (click)=\"isNavbarCollapsed = !isNavbarCollapsed\">\r\n            <span>\r\n                <img alt=\"navbarToggler\" src=\"assets/images/navbar-toggler.png\">\r\n            </span>\r\n        </button>\r\n\r\n        <!-- ## CORPO DELLA NAVBAR COLLASSABILE ## -->\r\n        <div class=\"collapse navbar-collapse justify-content-end\" [ngbCollapse]=\"isNavbarCollapsed\">\r\n            <!-- ## LISTA DEGLI ELEMENTI DELLA NAVBAR ## -->\r\n            <ul class=\"list-group list-group-horizontal align-items-center justify-content-center\">\r\n\r\n                <!-- ## NOME E COGNOME UTENTE - SOLO TESTO ## -->\r\n                <li *ngIf=\"isNavbarCollapsed\" class=\"list-group-item\">\r\n                    <div class=\"nav-link user-menu\">\r\n                        {{userDTO?.name}} {{userDTO?.surname}}\r\n                    </div>\r\n                </li>\r\n\r\n                <li *ngIf=\"userDTO\" ngbDropdown class=\"list-group-item\">\r\n                    <div ngbDropdown class=\"dropdown\">\r\n                        <button ngbDropdownToggle class=\"user-menu\">\r\n                            <img alt=\"user status\" src=\"assets/images/{{ userDTO!.propertiesDTO!.status }}.png\" />\r\n                        </button>\r\n                        <div ngbDropdownMenu>\r\n                            <button *ngFor=\"let status of stati\" class=\"btn\" ngbDropdownItem\r\n                                (click)=\"updateStatus(status.name)\">\r\n                                <img class=\"me-2\" alt=\"{{status.name}}\" src=\"{{ status.iconPath }}\" />\r\n                                {{\"generic.\" + status.name | translate}}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n\r\n                <!-- ## USER MENU ## -->\r\n                <li ngbDropdown class=\"list-group-item\">\r\n                    <button *ngIf=\"!userDTO\" class=\"user-menu\" (click)=\"login()\">{{'Login'}}</button>\r\n                    <div *ngIf=\"userDTO\">\r\n                        <button ngbDropdownToggle class=\"user-menu\">\r\n                            <img alt=\"profilePicture\" class=\"rounded-5\" src=\"{{userDTO.propertiesDTO?.profilePicture}}\"\r\n                                width=\"32\" height=\"32\">\r\n                        </button>\r\n                        <div ngbDropdownMenu class=\"dropdown-menu\">\r\n                            <button ngbDropdownItem routerLink=\"/profile\">{{\"generic.profile\"|translate}}</button>\r\n                            <button ngbDropdownItem (click)=\"logout()\">{{'Logout'}}</button>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n\r\n                <!-- ## LANGUAGE SELECTOR ## -->\r\n                <li ngbDropdown class=\"list-group-item\">\r\n                    <button ngbDropdownToggle class=\"user-menu\">\r\n                        <!--\r\n                            Aggiungere salvataggio a db e update\r\n                            <img src='assets/images/{{userDto?.propertiesDTO?.defaultLanguage}}.png'>\r\n                        -->\r\n                        <img alt=\"languageFlag\" src='{{\"lang.flag-picture\" | translate}}'>\r\n                    </button>\r\n                    <div ngbDropdownMenu class=\"dropdown-menu\">\r\n                        <button *ngFor=\"let language of languages\" ngbDropdownItem\r\n                            (click)=\"changeLanguage(language.langIdentifier)\">\r\n                            <img alt=\"flagLanguageDropdown\" src='{{language.flagPath}}'>\r\n                        </button>\r\n                    </div>\r\n                </li>\r\n\r\n            </ul>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</nav>", styles: ["div.container-fluid{background:#130044;box-shadow:0 10px 50px #13004440;border-radius:.625rem;margin:1.125rem 1.25rem 0rem;min-height:5.813rem;height:100px}.navbar-brand{position:relative;left:50%;transform:translate(-50%);display:block}li.list-group-item{background:transparent;border:none}.dropdown-menu{border-radius:.625rem;min-width:inherit;padding:.25rem}button:hover,li.dropdown-item{background-color:transparent}.user-menu{border:none;background:transparent;color:#fff;white-space:nowrap}img.rounded-5{object-fit:cover}.badge{background-color:#fff;color:#130044}.dropdown-notification-toggle{color:#130044}.notification-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:21rem}.notification-text-new{color:#130044}ul.dropdown-menu{min-width:15rem;max-height:10rem;overflow-y:auto}li:active{color:#130044}hr.dropdown-divider{margin:auto;margin-top:.125rem;margin-bottom:.125rem}.home{position:absolute;left:-800px;top:-5px;height:25px;width:25px}\n"], dependencies: [{ kind: "directive", type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i7.NgbCollapse, selector: "[ngbCollapse]", inputs: ["animation", "ngbCollapse", "horizontal"], outputs: ["ngbCollapseChange", "shown", "hidden"], exportAs: ["ngbCollapse"] }, { kind: "directive", type: i7.NgbDropdown, selector: "[ngbDropdown]", inputs: ["autoClose", "dropdownClass", "open", "placement", "popperOptions", "container", "display"], outputs: ["openChange"], exportAs: ["ngbDropdown"] }, { kind: "directive", type: i7.NgbDropdownToggle, selector: "[ngbDropdownToggle]" }, { kind: "directive", type: i7.NgbDropdownMenu, selector: "[ngbDropdownMenu]" }, { kind: "directive", type: i7.NgbDropdownItem, selector: "[ngbDropdownItem]", inputs: ["disabled"] }, { kind: "directive", type: i8.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: HeaderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'cube-header', template: "<nav class=\"navbar navbar-expand-xl\">\r\n    <div class=\"container-fluid\">\r\n\r\n        <!-- ## NAVBAR HOME TO PORTAL ## -->\r\n        <div class=\"navbar-brand\">\r\n            <a href=\"https://docmon.pccube.com/portal\">\r\n                <img alt=\"cubePortalLogo\" class=\"home\" src=\"assets/images/pccube-solo-cubo.png\">\r\n            </a>\r\n        </div>\r\n\r\n        <!-- ## NAVBAR LOGO ## -->\r\n        <div class=\"navbar-brand\">\r\n            <img alt=\"cubeChatLogo\" routerLink=\"/\" style=\"cursor:pointer;width: 275px; height: 50px;\"\r\n                src=\"assets/images/pccube.png\">\r\n        </div>\r\n\r\n        <!-- ## NAVBAR TOGGLER - QUANDO SCHERMO PICCOLO ## -->\r\n        <button class=\"navbar-toggler shadow-none\" (click)=\"isNavbarCollapsed = !isNavbarCollapsed\">\r\n            <span>\r\n                <img alt=\"navbarToggler\" src=\"assets/images/navbar-toggler.png\">\r\n            </span>\r\n        </button>\r\n\r\n        <!-- ## CORPO DELLA NAVBAR COLLASSABILE ## -->\r\n        <div class=\"collapse navbar-collapse justify-content-end\" [ngbCollapse]=\"isNavbarCollapsed\">\r\n            <!-- ## LISTA DEGLI ELEMENTI DELLA NAVBAR ## -->\r\n            <ul class=\"list-group list-group-horizontal align-items-center justify-content-center\">\r\n\r\n                <!-- ## NOME E COGNOME UTENTE - SOLO TESTO ## -->\r\n                <li *ngIf=\"isNavbarCollapsed\" class=\"list-group-item\">\r\n                    <div class=\"nav-link user-menu\">\r\n                        {{userDTO?.name}} {{userDTO?.surname}}\r\n                    </div>\r\n                </li>\r\n\r\n                <li *ngIf=\"userDTO\" ngbDropdown class=\"list-group-item\">\r\n                    <div ngbDropdown class=\"dropdown\">\r\n                        <button ngbDropdownToggle class=\"user-menu\">\r\n                            <img alt=\"user status\" src=\"assets/images/{{ userDTO!.propertiesDTO!.status }}.png\" />\r\n                        </button>\r\n                        <div ngbDropdownMenu>\r\n                            <button *ngFor=\"let status of stati\" class=\"btn\" ngbDropdownItem\r\n                                (click)=\"updateStatus(status.name)\">\r\n                                <img class=\"me-2\" alt=\"{{status.name}}\" src=\"{{ status.iconPath }}\" />\r\n                                {{\"generic.\" + status.name | translate}}\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n\r\n                <!-- ## USER MENU ## -->\r\n                <li ngbDropdown class=\"list-group-item\">\r\n                    <button *ngIf=\"!userDTO\" class=\"user-menu\" (click)=\"login()\">{{'Login'}}</button>\r\n                    <div *ngIf=\"userDTO\">\r\n                        <button ngbDropdownToggle class=\"user-menu\">\r\n                            <img alt=\"profilePicture\" class=\"rounded-5\" src=\"{{userDTO.propertiesDTO?.profilePicture}}\"\r\n                                width=\"32\" height=\"32\">\r\n                        </button>\r\n                        <div ngbDropdownMenu class=\"dropdown-menu\">\r\n                            <button ngbDropdownItem routerLink=\"/profile\">{{\"generic.profile\"|translate}}</button>\r\n                            <button ngbDropdownItem (click)=\"logout()\">{{'Logout'}}</button>\r\n                        </div>\r\n                    </div>\r\n                </li>\r\n\r\n                <!-- ## LANGUAGE SELECTOR ## -->\r\n                <li ngbDropdown class=\"list-group-item\">\r\n                    <button ngbDropdownToggle class=\"user-menu\">\r\n                        <!--\r\n                            Aggiungere salvataggio a db e update\r\n                            <img src='assets/images/{{userDto?.propertiesDTO?.defaultLanguage}}.png'>\r\n                        -->\r\n                        <img alt=\"languageFlag\" src='{{\"lang.flag-picture\" | translate}}'>\r\n                    </button>\r\n                    <div ngbDropdownMenu class=\"dropdown-menu\">\r\n                        <button *ngFor=\"let language of languages\" ngbDropdownItem\r\n                            (click)=\"changeLanguage(language.langIdentifier)\">\r\n                            <img alt=\"flagLanguageDropdown\" src='{{language.flagPath}}'>\r\n                        </button>\r\n                    </div>\r\n                </li>\r\n\r\n            </ul>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</nav>", styles: ["div.container-fluid{background:#130044;box-shadow:0 10px 50px #13004440;border-radius:.625rem;margin:1.125rem 1.25rem 0rem;min-height:5.813rem;height:100px}.navbar-brand{position:relative;left:50%;transform:translate(-50%);display:block}li.list-group-item{background:transparent;border:none}.dropdown-menu{border-radius:.625rem;min-width:inherit;padding:.25rem}button:hover,li.dropdown-item{background-color:transparent}.user-menu{border:none;background:transparent;color:#fff;white-space:nowrap}img.rounded-5{object-fit:cover}.badge{background-color:#fff;color:#130044}.dropdown-notification-toggle{color:#130044}.notification-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:21rem}.notification-text-new{color:#130044}ul.dropdown-menu{min-width:15rem;max-height:10rem;overflow-y:auto}li:active{color:#130044}hr.dropdown-divider{margin:auto;margin-top:.125rem;margin-bottom:.125rem}.home{position:absolute;left:-800px;top:-5px;height:25px;width:25px}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.KeycloakService }, { type: i2.TranslateService }, { type: i3.AuthService }, { type: i4.WebSocketService }, { type: i5.UserService }, { type: undefined, decorators: [{
                    type: Inject,
                    args: ['SHARED_CONFIG']
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2N1YmUvc2hhcmVkL3NyYy9saWIvY29tcG9uZW50L2hlYWRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jdWJlL3NoYXJlZC9zcmMvbGliL2NvbXBvbmVudC9oZWFkZXIuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBUSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFeEQsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLG1DQUFtQyxDQUFDOzs7Ozs7Ozs7O0FBYzNELE1BQU0sT0FBTyxlQUFlO0lBc0IxQixZQUNVLFFBQXlCLEVBQ3pCLGdCQUFrQyxFQUNsQyxJQUFpQixFQUNqQixTQUEyQixFQUMzQixXQUF3QixFQUNDLE1BQW9CO1FBTDdDLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQ3pCLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBa0I7UUFDbEMsU0FBSSxHQUFKLElBQUksQ0FBYTtRQUNqQixjQUFTLEdBQVQsU0FBUyxDQUFrQjtRQUMzQixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUNDLFdBQU0sR0FBTixNQUFNLENBQWM7UUExQnZELFdBQU0sR0FBWSwyQkFBMkIsQ0FBQztRQUM5QyxTQUFJLEdBQUcsTUFBTSxDQUFDO1FBQ2QsY0FBUyxHQUFlLEVBQUUsQ0FBQztRQUMzQixzQkFBaUIsR0FBRyxJQUFJLENBQUM7UUFFekIsVUFBSyxHQUFhO1lBQ2hCO2dCQUNFLElBQUksRUFBRSxRQUFRO2dCQUNkLFFBQVEsRUFBRSwwQkFBMEI7YUFDckM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsTUFBTTtnQkFDWixRQUFRLEVBQUUsd0JBQXdCO2FBQ25DO1lBQ0Q7Z0JBQ0UsSUFBSSxFQUFFLFdBQVc7Z0JBQ2pCLFFBQVEsRUFBRSw2QkFBNkI7YUFDeEM7U0FDRixDQUFDO1FBVUEsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO1FBQ3BELElBQUksQ0FBQyxTQUFTLEdBQUc7WUFDZjtnQkFDRSxJQUFJLEVBQUUsU0FBUztnQkFDZixjQUFjLEVBQUUsT0FBTztnQkFDdkIsUUFBUSxFQUFFLHlCQUF5QjthQUNwQztZQUNEO2dCQUNFLElBQUksRUFBRSxVQUFVO2dCQUNoQixjQUFjLEVBQUUsT0FBTztnQkFDdkIsUUFBUSxFQUFFLHlCQUF5QjthQUNwQztZQUNEO2dCQUNFLElBQUksRUFBRSxVQUFVO2dCQUNoQixjQUFjLEVBQUUsT0FBTztnQkFDdkIsUUFBUSxFQUFFLHlCQUF5QjthQUNwQztTQUNGLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDWCxDQUFDO0lBRUQsUUFBUTtRQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsU0FBUyxDQUFDO1lBQ3pDLElBQUksRUFBRSxDQUFDLGVBQW9CLEVBQUUsRUFBRTtnQkFDN0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxlQUFlLENBQUM7Z0JBQy9CLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxhQUFhLEVBQUUsZUFBZSxFQUFFO29CQUNoRCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxDQUFDO2lCQUN2RTtZQUNILENBQUM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsS0FBSztRQUNILElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDO1lBQ2xCLFdBQVcsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLHlCQUF5QjtTQUNuRCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsTUFBTTtRQUNKLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUNwQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELGNBQWMsQ0FBQyxJQUFZO1FBQ3pCLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVELFlBQVksQ0FBQyxNQUFjO1FBQ3pCLElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQztZQUM5QyxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsRUFBRTtnQkFDakIsSUFBSSxRQUFRLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtvQkFDNUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFjLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztvQkFDNUMsSUFBSSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2lCQUNyRDtZQUNILENBQUM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDOytHQXRGVSxlQUFlLHVLQTRCaEIsZUFBZTttR0E1QmQsZUFBZSxtRENoQjVCLDQ5SUF1Rk07OzRGRHZFTyxlQUFlO2tCQUwzQixTQUFTOytCQUNFLGFBQWE7OzBCQWdDcEIsTUFBTTsyQkFBQyxlQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LE9uSW5pdCxJbmplY3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFRyYW5zbGF0ZVNlcnZpY2UgfSBmcm9tICdAbmd4LXRyYW5zbGF0ZS9jb3JlJztcbmltcG9ydCB7IGZhQ3ViZSB9IGZyb20gJ0Bmb3J0YXdlc29tZS9mcmVlLXNvbGlkLXN2Zy1pY29ucyc7XG5pbXBvcnQgeyBLZXljbG9ha1NlcnZpY2UgfSBmcm9tICdrZXljbG9hay1hbmd1bGFyJztcbmltcG9ydCB7IEtleWNsb2FrTG9naW5PcHRpb25zIH0gZnJvbSAna2V5Y2xvYWstanMnO1xuaW1wb3J0IHsgU2hhcmVkQ29uZmlnIH0gZnJvbSAnLi4vc2hhcmVkLmludGVyZmFjZSc7XG5pbXBvcnQgeyBBdXRoU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2F1dGgvYXV0aC5zZXJ2aWNlJztcbmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdXNlci91c2VyLnNlcnZpY2UnO1xuaW1wb3J0IHsgV2ViU29ja2V0U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3dlYnNvY2tldC93ZWJzb2NrZXQuc2VydmljZSc7XG5pbXBvcnQgeyBMYW5ndWFnZSxTdGF0dXMsVXNlckRUTyB9IGZyb20gJy4uL3R5cGVzL3R5cGVzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnY3ViZS1oZWFkZXInLFxuICB0ZW1wbGF0ZVVybDogJy4vaGVhZGVyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vaGVhZGVyLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgSGVhZGVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgdXNlckRUTz86IFVzZXJEVE87XG4gIGltZ1NyYz86IHN0cmluZyA9ICdhc3NldHMvaW1hZ2VzL3Byb2ZpbGUuanBnJztcbiAgaWNvbiA9IGZhQ3ViZTtcbiAgbGFuZ3VhZ2VzOiBMYW5ndWFnZVtdID0gW107XG4gIGlzTmF2YmFyQ29sbGFwc2VkID0gdHJ1ZTtcblxuICBzdGF0aTogU3RhdHVzW10gPSBbXG4gICAge1xuICAgICAgbmFtZTogJ29ubGluZScsXG4gICAgICBpY29uUGF0aDogJ2Fzc2V0cy9pbWFnZXMvT05MSU5FLnBuZycsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnYnVzeScsXG4gICAgICBpY29uUGF0aDogJ2Fzc2V0cy9pbWFnZXMvQlVTWS5wbmcnLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ2ludmlzaWJsZScsXG4gICAgICBpY29uUGF0aDogJ2Fzc2V0cy9pbWFnZXMvSU5WSVNJQkxFLnBuZycsXG4gICAgfSxcbiAgXTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGtleWNsb2FrOiBLZXljbG9ha1NlcnZpY2UsXG4gICAgcHJpdmF0ZSB0cmFuc2xhdGVTZXJ2aWNlOiBUcmFuc2xhdGVTZXJ2aWNlLFxuICAgIHByaXZhdGUgYXV0aDogQXV0aFNlcnZpY2UsXG4gICAgcHJpdmF0ZSB3ZWJTb2NrZXQ6IFdlYlNvY2tldFNlcnZpY2UsXG4gICAgcHJpdmF0ZSB1c2VyU2VydmljZTogVXNlclNlcnZpY2UsXG4gICAgQEluamVjdCgnU0hBUkVEX0NPTkZJRycpIHByaXZhdGUgY29uZmlnOiBTaGFyZWRDb25maWdcbiAgKSB7XG4gICAgY29uc29sZS5sb2coJ0hlYWRlckNvbXBvbmVudCBjb3N0cnV0dG9yZSBjaGlhbWF0bycpO1xuICAgIHRoaXMubGFuZ3VhZ2VzID0gW1xuICAgICAge1xuICAgICAgICBuYW1lOiAnRW5nbGlzaCcsXG4gICAgICAgIGxhbmdJZGVudGlmaWVyOiAnZW4tRU4nLFxuICAgICAgICBmbGFnUGF0aDogJ2Fzc2V0cy9pbWFnZXMvZW4tRU4ucG5nJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdJdGFsaWFubycsXG4gICAgICAgIGxhbmdJZGVudGlmaWVyOiAnaXQtSVQnLFxuICAgICAgICBmbGFnUGF0aDogJ2Fzc2V0cy9pbWFnZXMvaXQtSVQucG5nJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICdGcmFuw6dhaXMnLFxuICAgICAgICBsYW5nSWRlbnRpZmllcjogJ2ZyLUZSJyxcbiAgICAgICAgZmxhZ1BhdGg6ICdhc3NldHMvaW1hZ2VzL2ZyLUZSLnBuZycsXG4gICAgICB9XG4gICAgXS5zb3J0KCk7XG4gIH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmF1dGgudXNlckRUT0JlaGF2aW9yU3ViamVjdC5zdWJzY3JpYmUoe1xuICAgICAgbmV4dDogKHJlY2VpdmVkVXNlckRUTzogYW55KSA9PiB7XG4gICAgICAgIHRoaXMudXNlckRUTyA9IHJlY2VpdmVkVXNlckRUTztcbiAgICAgICAgaWYgKHRoaXMudXNlckRUTz8ucHJvcGVydGllc0RUTz8uZGVmYXVsdExhbmd1YWdlKSB7XG4gICAgICAgICAgdGhpcy50cmFuc2xhdGVTZXJ2aWNlLnVzZSh0aGlzLnVzZXJEVE8ucHJvcGVydGllc0RUTy5kZWZhdWx0TGFuZ3VhZ2UpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgbG9naW4oKSB7XG4gICAgdGhpcy5rZXljbG9hay5sb2dpbih7XG4gICAgICByZWRpcmVjdFVyaTogdGhpcy5jb25maWcubG9naW5SZWRpcmVjdENoYXRIb21lUGFnZSBcbiAgICB9KTtcbiAgfVxuXG4gIGxvZ291dCgpOiB2b2lkIHtcbiAgICB0aGlzLndlYlNvY2tldC5kaXNjb25uZWN0KCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLmtleWNsb2FrLmxvZ291dCh0aGlzLmNvbmZpZy5yZWRpcmVjdFVyaSk7XG4gICAgfSk7XG4gIH1cblxuICBjaGFuZ2VMYW5ndWFnZShsYW5nOiBzdHJpbmcpIHtcbiAgICB0aGlzLnRyYW5zbGF0ZVNlcnZpY2UudXNlKGxhbmcpO1xuICB9XG5cbiAgdXBkYXRlU3RhdHVzKHN0YXR1czogc3RyaW5nKSB7XG4gICAgdGhpcy51c2VyU2VydmljZS51cGRhdGVTdGF0dXMoc3RhdHVzKS5zdWJzY3JpYmUoe1xuICAgICAgbmV4dDogKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIGlmIChyZXNwb25zZSAmJiB0aGlzLnVzZXJEVE8pIHtcbiAgICAgICAgICB0aGlzLnVzZXJEVE8ucHJvcGVydGllc0RUTyEuc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICAgIHRoaXMuYXV0aC51c2VyRFRPQmVoYXZpb3JTdWJqZWN0Lm5leHQodGhpcy51c2VyRFRPKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxufSIsIjxuYXYgY2xhc3M9XCJuYXZiYXIgbmF2YmFyLWV4cGFuZC14bFwiPlxyXG4gICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci1mbHVpZFwiPlxyXG5cclxuICAgICAgICA8IS0tICMjIE5BVkJBUiBIT01FIFRPIFBPUlRBTCAjIyAtLT5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwibmF2YmFyLWJyYW5kXCI+XHJcbiAgICAgICAgICAgIDxhIGhyZWY9XCJodHRwczovL2RvY21vbi5wY2N1YmUuY29tL3BvcnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGltZyBhbHQ9XCJjdWJlUG9ydGFsTG9nb1wiIGNsYXNzPVwiaG9tZVwiIHNyYz1cImFzc2V0cy9pbWFnZXMvcGNjdWJlLXNvbG8tY3Viby5wbmdcIj5cclxuICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICA8IS0tICMjIE5BVkJBUiBMT0dPICMjIC0tPlxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJuYXZiYXItYnJhbmRcIj5cclxuICAgICAgICAgICAgPGltZyBhbHQ9XCJjdWJlQ2hhdExvZ29cIiByb3V0ZXJMaW5rPVwiL1wiIHN0eWxlPVwiY3Vyc29yOnBvaW50ZXI7d2lkdGg6IDI3NXB4OyBoZWlnaHQ6IDUwcHg7XCJcclxuICAgICAgICAgICAgICAgIHNyYz1cImFzc2V0cy9pbWFnZXMvcGNjdWJlLnBuZ1wiPlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICA8IS0tICMjIE5BVkJBUiBUT0dHTEVSIC0gUVVBTkRPIFNDSEVSTU8gUElDQ09MTyAjIyAtLT5cclxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwibmF2YmFyLXRvZ2dsZXIgc2hhZG93LW5vbmVcIiAoY2xpY2spPVwiaXNOYXZiYXJDb2xsYXBzZWQgPSAhaXNOYXZiYXJDb2xsYXBzZWRcIj5cclxuICAgICAgICAgICAgPHNwYW4+XHJcbiAgICAgICAgICAgICAgICA8aW1nIGFsdD1cIm5hdmJhclRvZ2dsZXJcIiBzcmM9XCJhc3NldHMvaW1hZ2VzL25hdmJhci10b2dnbGVyLnBuZ1wiPlxyXG4gICAgICAgICAgICA8L3NwYW4+XHJcbiAgICAgICAgPC9idXR0b24+XHJcblxyXG4gICAgICAgIDwhLS0gIyMgQ09SUE8gREVMTEEgTkFWQkFSIENPTExBU1NBQklMRSAjIyAtLT5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29sbGFwc2UgbmF2YmFyLWNvbGxhcHNlIGp1c3RpZnktY29udGVudC1lbmRcIiBbbmdiQ29sbGFwc2VdPVwiaXNOYXZiYXJDb2xsYXBzZWRcIj5cclxuICAgICAgICAgICAgPCEtLSAjIyBMSVNUQSBERUdMSSBFTEVNRU5USSBERUxMQSBOQVZCQVIgIyMgLS0+XHJcbiAgICAgICAgICAgIDx1bCBjbGFzcz1cImxpc3QtZ3JvdXAgbGlzdC1ncm91cC1ob3Jpem9udGFsIGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCI+XHJcblxyXG4gICAgICAgICAgICAgICAgPCEtLSAjIyBOT01FIEUgQ09HTk9NRSBVVEVOVEUgLSBTT0xPIFRFU1RPICMjIC0tPlxyXG4gICAgICAgICAgICAgICAgPGxpICpuZ0lmPVwiaXNOYXZiYXJDb2xsYXBzZWRcIiBjbGFzcz1cImxpc3QtZ3JvdXAtaXRlbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJuYXYtbGluayB1c2VyLW1lbnVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAge3t1c2VyRFRPPy5uYW1lfX0ge3t1c2VyRFRPPy5zdXJuYW1lfX1cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvbGk+XHJcblxyXG4gICAgICAgICAgICAgICAgPGxpICpuZ0lmPVwidXNlckRUT1wiIG5nYkRyb3Bkb3duIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBuZ2JEcm9wZG93biBjbGFzcz1cImRyb3Bkb3duXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gbmdiRHJvcGRvd25Ub2dnbGUgY2xhc3M9XCJ1c2VyLW1lbnVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgYWx0PVwidXNlciBzdGF0dXNcIiBzcmM9XCJhc3NldHMvaW1hZ2VzL3t7IHVzZXJEVE8hLnByb3BlcnRpZXNEVE8hLnN0YXR1cyB9fS5wbmdcIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBuZ2JEcm9wZG93bk1lbnU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uICpuZ0Zvcj1cImxldCBzdGF0dXMgb2Ygc3RhdGlcIiBjbGFzcz1cImJ0blwiIG5nYkRyb3Bkb3duSXRlbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJ1cGRhdGVTdGF0dXMoc3RhdHVzLm5hbWUpXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBjbGFzcz1cIm1lLTJcIiBhbHQ9XCJ7e3N0YXR1cy5uYW1lfX1cIiBzcmM9XCJ7eyBzdGF0dXMuaWNvblBhdGggfX1cIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7XCJnZW5lcmljLlwiICsgc3RhdHVzLm5hbWUgfCB0cmFuc2xhdGV9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9saT5cclxuXHJcbiAgICAgICAgICAgICAgICA8IS0tICMjIFVTRVIgTUVOVSAjIyAtLT5cclxuICAgICAgICAgICAgICAgIDxsaSBuZ2JEcm9wZG93biBjbGFzcz1cImxpc3QtZ3JvdXAtaXRlbVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gKm5nSWY9XCIhdXNlckRUT1wiIGNsYXNzPVwidXNlci1tZW51XCIgKGNsaWNrKT1cImxvZ2luKClcIj57eydMb2dpbid9fTwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJ1c2VyRFRPXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gbmdiRHJvcGRvd25Ub2dnbGUgY2xhc3M9XCJ1c2VyLW1lbnVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgYWx0PVwicHJvZmlsZVBpY3R1cmVcIiBjbGFzcz1cInJvdW5kZWQtNVwiIHNyYz1cInt7dXNlckRUTy5wcm9wZXJ0aWVzRFRPPy5wcm9maWxlUGljdHVyZX19XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD1cIjMyXCIgaGVpZ2h0PVwiMzJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgbmdiRHJvcGRvd25NZW51IGNsYXNzPVwiZHJvcGRvd24tbWVudVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBuZ2JEcm9wZG93bkl0ZW0gcm91dGVyTGluaz1cIi9wcm9maWxlXCI+e3tcImdlbmVyaWMucHJvZmlsZVwifHRyYW5zbGF0ZX19PC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG5nYkRyb3Bkb3duSXRlbSAoY2xpY2spPVwibG9nb3V0KClcIj57eydMb2dvdXQnfX08L2J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L2xpPlxyXG5cclxuICAgICAgICAgICAgICAgIDwhLS0gIyMgTEFOR1VBR0UgU0VMRUNUT1IgIyMgLS0+XHJcbiAgICAgICAgICAgICAgICA8bGkgbmdiRHJvcGRvd24gY2xhc3M9XCJsaXN0LWdyb3VwLWl0ZW1cIj5cclxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG5nYkRyb3Bkb3duVG9nZ2xlIGNsYXNzPVwidXNlci1tZW51XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwhLS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFnZ2l1bmdlcmUgc2FsdmF0YWdnaW8gYSBkYiBlIHVwZGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9J2Fzc2V0cy9pbWFnZXMve3t1c2VyRHRvPy5wcm9wZXJ0aWVzRFRPPy5kZWZhdWx0TGFuZ3VhZ2V9fS5wbmcnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAtLT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBhbHQ9XCJsYW5ndWFnZUZsYWdcIiBzcmM9J3t7XCJsYW5nLmZsYWctcGljdHVyZVwiIHwgdHJhbnNsYXRlfX0nPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgbmdiRHJvcGRvd25NZW51IGNsYXNzPVwiZHJvcGRvd24tbWVudVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uICpuZ0Zvcj1cImxldCBsYW5ndWFnZSBvZiBsYW5ndWFnZXNcIiBuZ2JEcm9wZG93bkl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjbGljayk9XCJjaGFuZ2VMYW5ndWFnZShsYW5ndWFnZS5sYW5nSWRlbnRpZmllcilcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcgYWx0PVwiZmxhZ0xhbmd1YWdlRHJvcGRvd25cIiBzcmM9J3t7bGFuZ3VhZ2UuZmxhZ1BhdGh9fSc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9saT5cclxuXHJcbiAgICAgICAgICAgIDwvdWw+XHJcblxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgIDwvZGl2PlxyXG48L25hdj4iXX0=